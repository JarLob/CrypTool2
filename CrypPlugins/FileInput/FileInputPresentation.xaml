<UserControl x:Class="FileInput.FileInputPresentation"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
    xmlns:wi="clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration"
    xmlns:wfuc="clr-namespace:FileInput.WindowsFormsUserControl"
    xmlns:fi="clr-namespace:FileInput"
    Height="302" Width="717">

  <UserControl.CommandBindings>    
    <CommandBinding Command="Save" PreviewExecuted="PreviewSave_Executed" CanExecute="Save_CanExecute" />
    <CommandBinding Command="New" PreviewExecuted="PreviewNew_Executed" CanExecute="New_CanExecute" />    
    <CommandBinding Command="fi:Commands.CutCommand" PreviewExecuted="PreviewCut_Executed" CanExecute="Cut_CanExecute" />
    <CommandBinding Command="fi:Commands.CopyCommand" PreviewExecuted="PreviewCopy_Executed" CanExecute="Copy_CanExecute" />
    <CommandBinding Command="Paste" Executed="PreviewPaste_Executed" CanExecute="Paste_CanExecute" />
    <CommandBinding Command="Find" PreviewExecuted="PreviewFind_Executed" CanExecute="Find_CanExecute" />
    <CommandBinding Command="fi:Commands.FindNextCommand" PreviewExecuted="PreviewFindNext_Executed" CanExecute="FindNext_CanExecute" />
    <CommandBinding Command="fi:Commands.AbortCommand" PreviewExecuted="PreviewAbort_Executed" CanExecute="Abort_CanExecute" />    
  </UserControl.CommandBindings>

  <Grid Background="Transparent">
    <Grid.RowDefinitions>
      <RowDefinition Height="50" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <StackPanel Name="stackPanel1" Grid.Row="0" MinHeight="55" Background="Transparent">
      <Menu Height="22" Name="menu">
        <MenuItem Header="{Loc File}">
        <MenuItem Header="{Loc Open}" Click="Open_Click" />
        <MenuItem Name="menuItemSave" Header="{Loc Save}" Command="Save" />
        <MenuItem Name="menuItemClose" Header="{Loc Close}" Click="Close_Click" />
        </MenuItem>
        <MenuItem Header="{Loc Edit}">
          <MenuItem Header="{Loc Cut}" Command="fi:Commands.CutCommand" />
          <MenuItem Header="{Loc Copy}" Command="fi:Commands.CopyCommand" />
          <MenuItem Header="{Loc Paste}" Command="Paste" />
          <Separator />
          <MenuItem Header="{Loc Find}" Command="Find"/>
          <MenuItem Header="{Loc Find_next}" InputGestureText="F3" Command="fi:Commands.FindNextCommand" />          
        </MenuItem>
                <MenuItem Header="{Loc Help}">
                    <MenuItem Header="{Loc About}" Click="About_Click"/>
        </MenuItem>
      </Menu>

      <ToolBarTray Background="Transparent">
        <ToolBar>
          <Button Name="buttonOpen" Click="Open_Click">
            <Canvas Width="16" Height="16" >
              <Polygon Stroke="Black" StrokeThickness="0.5" Fill="Khaki"
                 SnapsToDevicePixels="True"
                 Points="0.5,14.5 0.5,4.5 1.5,3.5 6.5,3.5 8.5,5.5
                         12.5,5.5 12.5,14.5" />
              <Polygon Stroke="Black" SnapsToDevicePixels="True"
                 StrokeThickness="0.5"
                 Points="1.5,14.5 4.5,7.5 15.5,7.5 12.5,14.5" >
                <Polygon.Fill>
                  <LinearGradientBrush StartPoint="0.25,0" EndPoint="0.5,1">
                    <GradientStop Offset="0" Color="#FF4" />
                    <GradientStop Offset="1" Color="#CA7" />
                  </LinearGradientBrush>
                </Polygon.Fill>
              </Polygon>
              <Path    Stroke="Blue" StrokeThickness="1"
                 Data="M 8,2 C 9,1 12,1 14,3"  />
              <Polygon Fill="Blue" Points="15,1 15.5,4.5 12,4" />
            </Canvas>
          </Button>
          <Button Name="buttonNew" Command="New">
            <Canvas Width="16" Height="16" SnapsToDevicePixels="True">
              <Polygon Stroke="Black" StrokeThickness="0.5"
                 Points="2.5,1.5 9.5,1.5 12.5,4.5 12.5,15 2.5,15">
                <Polygon.Fill>
                  <LinearGradientBrush StartPoint="1,1" EndPoint="0.2,0.7">
                    <GradientStop Offset="0" Color="#AAA" />
                    <GradientStop Offset="1" Color="White" />
                  </LinearGradientBrush>
                </Polygon.Fill>
              </Polygon>
              <Polygon Stroke="Black" Fill="DarkGray" StrokeThickness="0.5"
                 StrokeLineJoin="Bevel"
                 Points="9.5,1.5 9.5,4.5 12.5,4.5" />
            </Canvas>
          </Button>
          <Button Name="buttonSave" Command="Save" Content="{Loc Save}" />
          <Separator />
                    <Button Name="buttonCut" Command="fi:Commands.CutCommand" Content="{Loc Cut}" />
                    <Button Name="buttonCopy" Command="fi:Commands.CopyCommand" Content="{Loc Copy}" />
                    <Button Name="buttonPaste" Command="Paste" Content="{Loc Paste}" />
          <!--<Button Name="buttonClose" Click="Close_Click">Close</Button>-->
        </ToolBar>
        <ToolBar>
          <Label Content="{Loc Find_}"/>
          <TextBox Name="textBoxSearch" Width="100" Background="WhiteSmoke" BorderThickness="1" BorderBrush="Black" AllowDrop="True"></TextBox>
                    <Button Name="buttonFind" Command="Find" Content="{Loc Search}" />
                    <Button Name="buttonAbort" Command="fi:Commands.AbortCommand" Content="{Loc Cancel}" />
        </ToolBar>
        <ToolBar>
                    <ProgressBar Name="progressBar" ToolTip="{Loc Search_Progress}" MinWidth="100"/>
        </ToolBar>
      </ToolBarTray>
    </StackPanel>

    <DockPanel LastChildFill="True" Background="AliceBlue" Grid.Row="1">
            <TextBlock Name="tbFileClosedWhileRunning" Text="{Loc File_is_closed_while_executing}" Visibility="Collapsed"/>
      <wi:WindowsFormsHost Name="windowsFormsHost">
        <wfuc:HexBoxContainer x:Name="uscHexBox" />
      </wi:WindowsFormsHost>
    </DockPanel>
  </Grid>
</UserControl>
